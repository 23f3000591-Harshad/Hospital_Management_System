{% extends 'base2.html' %}
{% block title %}Doctor Dashboard{% endblock %}

{% block content %}
<div style="padding:24px; max-width:1000px; margin:0 auto;">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h2 style="color:#0A4D68; margin:0;">Welcome Dr. {{ doctor.user.name }}</h2>
        <a href="{{ url_for('views.doctor_availability') }}" style="padding:8px 12px; background:#e8f6ff; border:1px solid #cfeafc; border-radius:6px; text-decoration:none;">Set Availability</a>
    </div>

    <!-- Upcoming Appointments -->
    <div style="margin-top:18px; background:#fff; border:1px solid #e3e9ee; border-radius:8px; padding:14px;">
        <h3 style="margin:0 0 12px 0; color:#233a45;">Upcoming Appointments</h3>

        <table style="width:100%; border-collapse:collapse; font-family:Arial;">
        <thead>
            <tr style="text-align:left; background:#fbfdff; border-bottom:2px solid #eef3f6;">
            <th style="padding:8px 10px; width:80px;">Sr No.</th>
            <th style="padding:8px 10px;">Patient Name</th>
            <th style="padding:8px 10px;">Patient History</th>
            <th style="padding:8px 10px; width:240px;">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for a in upcoming %}
            <tr style="border-bottom:1px solid #f3f6f8;">
            <td style="padding:10px;">{{ loop.index }}</td>
            <td style="padding:10px;">{{ a.patient.user.name if a.patient and a.patient.user else '—' }}</td>
            <td style="padding:10px;">
                {% if a.treatment and a.treatment.notes %}{{ a.treatment.notes[:120] }}{% else %}—{% endif %}
            </td>
            <td style="padding:8px;">
                <a href="{{ url_for('views.update_appointment', appointment_id=a.id) }}"
                style="padding:6px 10px; margin-right:6px; background:#e8f6ff; color:#0a5f9a; border:1px solid #cfeafc; border-radius:6px; text-decoration:none; font-size:13px;">
                update
                </a>

                <form action="{{ url_for('views.complete_appointment', appointment_id=a.id) }}" method="POST" style="display:inline-block; margin:0 6px;">
                <button type="submit" style="padding:6px 10px; background:#b7f5d1; color:#116c3b; border:1px solid #b7f5d1; border-radius:6px; cursor:pointer; font-size:13px;">
                    mark as complete
                </button>
                </form>

                <form action="{{ url_for('views.cancel_appointment', appointment_id=a.id) }}" method="POST" style="display:inline-block; margin:0;">
                <button type="submit" style="padding:6px 10px; background:#ffefef; color:#b32b2b; border:1px solid #f5bdbd; border-radius:6px; cursor:pointer; font-size:13px;">
                    cancel
                </button>
                </form>
            </td>
            </tr>
            {% else %}
            <tr><td colspan="4" style="padding:12px; color:#64757f;">No upcoming appointments.</td></tr>
            {% endfor %}
        </tbody>
        </table>
    </div>
</div>
{% endblock %}
